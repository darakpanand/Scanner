

<html>
<head>
<script src="https://swx.cdn.skype.com/shared/v/1.2.15/SkypeBootstrap.min.js"></script>
<script>
function reset(){
            if (!location.hash) {
                         location.assign('https://login.windows.net/common/oauth2/authorize?response_type=token' +
                '&client_id=88a947ae-8854-46d5-acd9-9068e543c2d5' +
                '&redirect_uri='+ location.href +
                '&resource=https://webdir.online.lync.com');
document.getElementById('login').style.visibility = "visible";
document.getElementById('sync').style.visibility = "hidden";
            } else {
       //    document.getElementById('login').style.visibility = "hidden";
           document.getElementById('sync').innerHTML =  document.getElementById('sync').innerHTML + location.hash;           
            }
}
function initalizeSkype(name, psword) {
   Skype.initialize({ apiKey: '88a947ae-8854-46d5-acd9-9068e543c2d5' }, api => {
      var app = new api.application;
      app.signInManager.signIn ({
        username:  name,
        password:  psword
      }).then(() => {
        alert("signed in as" + app.personsAndGroupsManager.mePerson.displayName());
      }, err => {
        alert("cannot sign in" +  err);
      });
    }, err => {
      alert("cannot load the sdk package" + err);
    });
document.getElementById('login').style.visibility = "hidden";
document.getElementById('sync').style.visibility = "visible";
}
</script>
</head>
<body onload = "reset()">

<div id= "login">
<form action="javascript:void(0);">
  UserName:<br>
  <input type="text" name="firstname" id= "firstname">
  <br>
  Password:<br>
  <input type="text" name="lastname" id="lastname">
  <br><br>
  <input type="submit" value="Submit" onClick="initalizeSkype(document.getElementById('firstname').value,document.getElementById('lastname').value)">
</form> 
</div>
<div id= "sync">
Data sync in progress...
</div>
  </body>
</html>
